<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <title>Firebase Realtime Test</title>
  <script type="module">
    // Firebase SDK 読み込み
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    // ↓ ここにあなたの firebaseConfig を貼り付ける
    const firebaseConfig = {
      apiKey: "AIzaSyAYxyejiMqg2bWO9dx7zoDg4X9aLyZEgG8",
      authDomain: "online-tetris-souki.firebaseapp.com",
      databaseURL: "https://online-tetris-souki-default-rtdb.firebaseio.com",
      projectId: "online-tetris-souki",
      storageBucket: "online-tetris-souki.firebasestorage.app",
      messagingSenderId: "564189331569",
      appId: "1:564189331569:web:0c7e30ba76e88423c31bd0",
      measurementId: "G-1HYR4KWBDV"
    };

    // Firebase初期化
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // 書き込み（例: ボタン押したら送信）
    function sendData() {
      const text = document.getElementById("input").value;
      set(ref(db, "messages/test"), {
        message: text,
        time: Date.now()
      });
    }

    // 読み込み（リアルタイムで更新）
    const msgRef = ref(db, "messages/test");
    onValue(msgRef, (snapshot) => {
      const data = snapshot.val();
      document.getElementById("output").innerText =
        data ? `${data.message} (${new Date(data.time).toLocaleTimeString()})` : "データなし";
    });

    // グローバル関数化
    window.sendData = sendData;
  </script>
</head>

<body>
  <h1>Firebase × HTML</h1>
  <input id="input" placeholder="メッセージ入力" />
  <button onclick="sendData()">送信</button>
  <p id="output">読み込み中...</p>
</body>

</html>