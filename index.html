<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tetris</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Stick&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <div class="fixed-background-in-div"></div>
  <div class="match-start-dialog">
    バトルを開始します!
  </div>

  <div class="match-user-card-container">
    <div class="match-user-card" id="MatchUserCardLeft">ユーザー1</div>
    <div class="match-user-card" id="MatchUserCardRight">ユーザー2</div>
  </div>

  <div class="vsBoom-stage" id="vsBoom-stage">
    <div class="vsBoom-text" id="vsBoom-text">VS</div>
    <div class="vsBoom-sparks
  " aria-hidden="true">
      <span style="--vsdx:-120px; --vsdy:-40px;"></span>
      <span style="--vsdx:100px; --vsdy:-80px;"></span>
      <span style="--vsdx:-70px; --vsdy:120px;"></span>
      <span style="--vsdx:140px; --vsdy:40px;"></span>
      <span style="--vsdx:-140px; --vsdy:80px;"></span>
      <span style="--vsdx:60px; --vsdy:160px;"></span>
      <span style="--vsdx:-30px; --vsdy:200px;"></span>
      <span style="--vsdx:220px; --vsdy:-20px;"></span>
      <span style="--vsdx:-200px; --vsdy:-120px;"></span>
      <span style="--vsdx:0px; --vsdy:-160px;"></span>
    </div>
  </div>
  <div class="notification-banner" id="myNotificationBanner">
    <p class="message-text"><label class="request-from"></label><br>から対戦を申し込まれました!</p>
    <div class="progress-bar">
      <div class="progress-fill" style="width: 100%;"></div>
    </div>
  </div>
  <dialog class="accept_dialog">
    <label class="request-from"></label>と対戦しますか？
    <button onclick="accept(user_name,requested_name)">はい</button>
    <button onclick="close_accept()">いいえ</button>
  </dialog>
  <div class="header">
    <div class="header-title">Online Tetris</div>
    <label class="user-name-label"></label>
    <button class="login-button" onclick='document.querySelector(".login").showModal()'>Login</button>
  </div>
  <div hidden>
    <audio src="sound/hard-drop.mp3" class="hard-drop"></audio>
    <audio src="sound/t-spin.mp3" class="t-spin"></audio>
    <audio src="sound/tetris.mp3" class="tetris"></audio>
    <audio src="sound/btb.mp3" class="btb"></audio>
    <audio src="sound/move.mp3" class="move"></audio>
    <audio src="sound/line-delete.mp3" class="line-delete"></audio>
    <audio src="sound/show-card.mp3" class="show-card"></audio>
    <audio src="sound/battle-start.wav" class="battle-start"></audio>
    <audio src="sound/damage.mp3" class="damage"></audio>
    <audio src="bgm-ultra.mp3" class="bgm-ultra"></audio>
    <audio src="virtualbattle-clear.wav" class="virtualbattle-clear"></audio>
    <audio src="bgm-40line.m4a" class="bgm-40line" loop></audio>
    <audio src="bgm-virtualbattle.mp3" class="bgm-virtualbattle" loop></audio>
  </div>
  <label id="attack_type"></label>
  <div class="details">
    <label class="left-label APM" style="bottom: 30%;">APM: 0.0</label>
    <label class="left-label PPS" style="bottom: calc(30% - 20px);">PPS: 0.0</label>
    <label class="left-label LINES" style="bottom: calc(30% - 40px);">Lines: 0</label>
    <label class="left-label REN" style="bottom: calc(30% - 60px);">REN: 0</label>
    <label class="left-label SCORE" style="bottom: calc(30% - 80px);">Score: 0</label>
    <label class="left-label TIME" style="bottom: calc(30% - 100px);">Time: 0</label>
  </div>
  <div id="chart-container">
    <canvas id="myLineChart"></canvas>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
  <script src="chart-js.js"></script>
  <canvas id="tetris">お使いのブラウザではhtmlのcanvasが対応していません。</canvas>
  <div class="tile-card-container">
    <h3 class="title">Menu</h3>
    <button class="tile-card Ultra">
      <div class="tile-content">
        <h3>Ultra</h3>
      </div>
    </button>
    <button class="tile-card Forty-Line">
      <div class="tile-content">
        <h3>40 Line</h3>
      </div>
    </button>

    <button class="tile-card Marathon">
      <div class="tile-content">
        <h3>Marathon</h3>
      </div>
    </button>

    <button class="tile-card VirtualBattle">
      <div class="tile-content">
        <h3>VirtualBattle</h3>
      </div>
    </button>

    <button class="tile-card Watch" disabled="true">
      <div class="tile-content">
        <h3>Watch</h3>
      </div>
    </button>

    <button class="tile-card Setting">
      <div class="tile-content">
        <h3>Setting</h3>
      </div>
    </button>
  </div>
  <div class="wipe-in-box-container">
    <div class="wipe-in-box">
      Finish!
    </div>
  </div>
  <div class="result">
    <h3 class="title">Result</h3>
    <table style="margin:0 auto;font-size: 1.2em;">
      <tr>
        <th>APM</th>
        <td class="result-apm">0</td>
      </tr>
      <tr>
        <th>Attack</th>
        <td class="result-attack">0</td>
      </tr>
      <tr>
        <th>PPS</th>
        <td class="result-pps">0</td>
      </tr>
      <tr>
        <th>Lines</th>
        <td class="result-lines">0</td>
      </tr>
      <tr>
        <th>Score</th>
        <td class="result-score">0</td>
      </tr>
      <tr>
        <th>Time</th>
        <td class="result-time">0</td>
      </tr>
    </table>
    <button style="width: 100px; display: block; margin:0 auto;" onclick="back_to_menu()">もどる</button>
  </div>
  <input type="range" value="0" min="0" style="width: 100%; display: none" class="user">
  <button class="long-button request" onclick="beforeSendRequest()">対戦する!</button>
  <dialog class="setting-dialog">
    <h2 style="width: 100%; text-align: center;">設定</h2>
    <div class="slider-container center">
      <input type="range" min="1" max="10" value="10" class="slider" id="arr" />
      <p class="slider-value">ARR: <span id="arr-label">0</span></p>
    </div>

    <div class="slider-container center">
      <input type="range" min="0" max="20" value="6" class="slider" id="das" />
      <p class="slider-value">DAS: <span id="das-label">6</span></p>
    </div>

    <div class="slider-container center">
      <input type="range" min="1" max="20" value="20" class="slider" id="sdf" />
      <p class="slider-value">SDF: <span id="sdf-label">75</span></p>
    </div>
    <hr>
    <div style="width: 100%; text-align: center;">Virtual Battle</div>

    <div class="slider-container center">
      <input type="range" min="20" max="200" value="40" class="slider" id="virtualbattle-apm" />
      <p class="slider-value">APM: <span id="virtualbattle-apm-label">75</span></p>
    </div>

    <button style="width: 100%;" onclick="document.querySelector('.setting-dialog').close()">閉じる</button>
  </dialog>
  <dialog class="login">
    <h1 class="title" style="color: white;">Login</h1>
    <p>ユーザー名: <input class="username" type="email" style="width:fit-content" autocorrect="on"></p>
    <p>パスワード: <input class="password" type="password" style="width:fit-content" autocorrect="on"
        autocomplete="current-password"></p>
    <button style="width: 100%" onclick="login()" class="login-submit">ログイン</button>
    <a href="regist.html"
      style="width: 100%; text-align: center; display: block; color: white; margin: 20px 0;">ユーザー登録</a>
  </dialog>

  <script src="tetris.js"></script>
  <script src="setting.js"></script>
  <script src="login.js"></script>
  <script src="request.js"></script>
  <script src="connection.js" type="module"></script>
</body>

</html>